"use strict";var usersController=function(){function e(e){templates.get("login").then(function(t){e.$element().html(t());var n=document.getElementById("txtEmail"),o=document.getElementById("txtPassword"),i=document.getElementById("btnLogin");document.getElementById("btnSignUp"),document.getElementById("btnLogout");i.addEventListener("click",function(e){var t=n.value,i=o.value,l=firebase.auth(),u=l.signInWithEmailAndPassword(t,i);u.then(function(e){return toastr.success("User logged in!")}),u.catch(function(e){return toastr.error(e.message)})}),firebase.auth().onAuthStateChanged(function(t){t?(console.log("logged in"),e.redirect("#/"),$("#btnLogin").hide(),$("#link-login").hide(),$("#link-logout").show()):($("#btnLogout").hide(),$("#link-logout").hide(),console.log("not logged in"))})})}function t(e){templates.get("signup").then(function(t){e.$element().html(t());var n=document.getElementById("txtEmail"),o=document.getElementById("txtPassword"),i=(document.getElementById("btnLogin"),document.getElementById("btnSignUp")),l=(document.getElementById("btnLogout"),document.getElementById("uname"));i.addEventListener("click",function(e){var t=n.value,i=o.value,u=l.value,s=firebase.auth(),r=s.createUserWithEmailAndPassword(t,i);r.catch(function(e){return console.log(e.message)}),r.then(function(e){return console.log("registred")}),r.then(function(e){return toastr.success("User registred!")}),firebase.auth().onAuthStateChanged(function(e){if(e){console.log(u);firebase.database().ref().child("users/"+e.uid).set({username:u,email:t})}})})})}function n(e){document.getElementById("link-logout").addEventListener("click",function(t){firebase.auth().signOut(),toastr.success("Logged out"),e.redirect("#/login"),$("#btnLogin").show(),$("#link-logout").hide(),$("#link-login").show()})}function o(e){templates.get("profile").then(function(t){var n,o,i=firebase.auth().currentUser;if(null!=i){n=i.uid;firebase.database().ref("users").child(n).on("value",function(n){o=n.val(),console.log(o),console.log(o.username),e.$element().html(t(o))})}else toastr.info("You have to logged in!"),e.redirect("#/login")})}return{login:e,signup:t,logout:n,currentUser:o}}();